# Introduction to docker

Contains a simple script that just logs the time once per second.
Has three different Dockerfiles that show different ways you can create
images.

* *Dockerfile.simple*: build your jar file locally and then copy it to the image
* *Dockerfile.bad*: fails to adequetly cache parts of the build, and so takes
	much longer to rebuild when making small changes.
* *Dockerfile*: Comprehensive dockerfile that builds the jar file in docker,
	minimises image size, and caches things like dependencies.


## How to install docker (on debian/ubuntu)

```shell
sudo apt install docker.io
sudo usermod -aG docker ${USER}
# now restart your machine or run:
newgrp docker  # only works for the current shell
```


## Building an image

`cd` to your directory containing `Dockerfile` and put the resulting
image in the `myapp` (local) repository. NB. You can use any name you want,
 you are not required to use `myapp`.

```shell
docker build . -t myapp
docker image ls
```

## Running a container

Run a previously built image, that is fully cleaned up after it exits.

```shell
docker run --rm -it myapp
# find the name(s) of your running containers
docker container ls
```

Run a different command to the default provided by the image. This container
also persists after it exits (no `--rm`).

```shell
docker run -it myapp echo hello world
```

Set a container running, but to not attach to your current shell.
Plus (re)attach to the container at a later stage.

```shell
docker run -d myapp
docker container ls
docker container attach $container_name
```


## Logs

Look at *all* logs generated by the container.

```shell
docker logs $container_name
```

Only look at logs generated in the last 10 seconds. You can also use `m` for
 minutes, `h` for hours, or a timestamp like `2022-03-29T10:00:00Z`, or even
provide an upper bound to the time you're interested with 

```
docker logs $container_name --since 10s
```

## Cleaning up your containers

Commands to stop a container, see stopped containers (that could be restarted),
and delete a stopped container.

```shell
docker container stop $container_name
docker container ls --all
docker container rm $container_name
```

## Quick ways to get help with docker

Use the help command or look at the man page for a given command.

```shell
docker help
docker help run
man docker-run
```

## Further Reading

Includes details on how to run a webapp in your container and be able to
connect to it.

https://docker-curriculum.com

Find prebuild docker images to use with the `FROM` command. NB. you do not need
to sign up to search for images.

https://hub.docker.com

